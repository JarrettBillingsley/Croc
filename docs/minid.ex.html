
<html><head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta content="text/javascript" http-equiv="content-script-type">
<title>minid.ex</title>
<link rel="stylesheet" type="text/css" href="candydoc/style.css">
<!--[if lt IE 7]><link rel="stylesheet" type="text/css" href="candydoc/ie56hack.css"><![endif]-->
<script language="JavaScript" src="candydoc/util.js" type="text/javascript"></script>
<script language="JavaScript" src="candydoc/tree.js" type="text/javascript"></script>
<script language="JavaScript" src="candydoc/explorer.js" type="text/javascript"></script>
</head><body>
<div id="tabarea"></div><div id="explorerclient"></div>
<div id="content"><script>explorer.initialize("minid.ex");</script>
	<table class="content">
		<tr><td id="docbody"><h1>minid.ex</h1><!-- Generated by Ddoc from minid\ex.d -->
<b>License:</b><br>
Copyright (c) 2008 Jarrett Billingsley
<br><br>

This software is provided 'as-is', without any express or implied warranty.
In no event will the authors be held liable for any damages arising from the
use of this software.
<br><br>

Permission is granted to anyone to use this software for any purpose,
including commercial applications, and to alter it and redistribute it freely,
subject to the following restrictions:
<br><br>

    1. The origin of this software must not be misrepresented; you must not
	claim that you wrote the original software. If you use this software in a
	product, an acknowledgment in the product documentation would be
	appreciated but is not required.
<br><br>

    2. Altered source versions must be plainly marked as such, and must not
	be misrepresented as being the original software.
<br><br>

    3. This notice may not be removed or altered from any source distribution.
<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">struct 
<span class="currsymbol">StrBuffer</span>
<script>explorer.outline.addDecl('StrBuffer');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>A utility structure for building up strings out of several pieces more efficiently than by just pushing
all the bits and concatenating.  This struct keeps an internal buffer so that strings are built up in
large chunks.
<br><br>
This struct uses the stack of a thread to hold its intermediate results, so if you perform any stack
manipulation to calls to this struct's functions, make sure your stack operations are balanced, or you
will mess up the string building.  Also, negative stack indices may change where they reference during
string building since the stack may grow, so be sure to use absolute (positive) indices where necessary.
<br><br>

A typical use looks something like this:
<br><br>

<pre class="d_code"><font color=blue>auto</font> buf = ex.<u>StrBuffer</u>(t);
buf.addString(someString);
buf.addChar(someChar);
<font color=green>// ...
</font><font color=blue>auto</font> strIdx = buf.finish();
<font color=green>// The stack is how it was before we created the buffer, except with the result string is on top.
</font></pre>
<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">static StrBuffer 
<span class="currsymbol">opCall</span>
<script>explorer.outline.addDecl('opCall');</script>

(MDThread* <span class="funcparam">t</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Create an instance of this struct.  The struct is bound to a single thread.
	
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">addChar</span>
<script>explorer.outline.addDecl('addChar');</script>

(dchar <span class="funcparam">c</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Add a character to the internal buffer.
	
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">addString</span>
<script>explorer.outline.addDecl('addString');</script>

(dchar[] <span class="funcparam">s</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Add a string to the internal buffer.
	
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">addTop</span>
<script>explorer.outline.addDecl('addTop');</script>

();
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Add the value on top of the stack to the buffer.  This is the only function that breaks the
	rule of leaving the stack balanced.  For this function to work, you must have exactly one
	value on top of the stack, and it must be a string or a char.
	
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">uint 
<span class="currsymbol">sink</span>
<script>explorer.outline.addDecl('sink');</script>

(dchar[] <span class="funcparam">s</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>A convenience function for hooking up to the Tango IO and formatting facilities.  You can pass
	"&buf.sink" to many Tango functions that expect a sink function for string data.
	
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">int 
<span class="currsymbol">finish</span>
<script>explorer.outline.addDecl('finish');</script>

();
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Indicate that the string building is complete.  This function will leave just the finished string
	on top of the stack.  The StrBuffer will also be in a state to build a new string if you so desire.
	
<br><br>

</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">int 
<span class="currsymbol">lookup</span>
<script>explorer.outline.addDecl('lookup');</script>

(MDThread* <span class="funcparam">t</span>, dchar[] <span class="funcparam">name</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Look up some value using a <span class="funcparam">name</span> that looks like a chain of dot-separated identifiers (like a MiniD expression).
The name must follow the regular expression "\w[\w\d]*(\.\w[\w\d]*)*".  No spaces are allowed.  The looked-up
value is left at the top of the stack.
<br><br>
This functions behaves just as though you were evaluating this expression in MiniD.  Global lookup and opField
metamethods are respected.
<br><br>

<pre class="d_code"><font color=blue>auto</font> slot = ex.<u>lookup</u>(<i>t</i>, <font color=red>"time.Timer"</font>);
pushNull(<i>t</i>);
methodCall(<i>t</i>, slot, <font color=red>"clone"</font>, 1);
<font color=green>// We now have an instance of time.Timer on top of the stack.
</font></pre>

If you want to set a long name, such as "foo.bar.baz.quux", you just lookup everything but the last name and
use 'fielda' to set it:
<br><br>

<pre class="d_code"><font color=blue>auto</font> slot = ex.<u>lookup</u>(<i>t</i>, <font color=red>"foo.bar.baz"</font>);
pushInt(<i>t</i>, 5);
fielda(<i>t</i>, slot, <font color=red>"quux"</font>);
</pre>

<br><br>
<b>Params:</b><br>
<table><tr>
<td nowrap valign="top" style="padding-right: 8px">dchar[] <span class="funcparam">name</span></td>

               
<td>The dot-separated name of the value to look up.</td></tr>
</table><br>
<b>Returns:</b><br>
The stack index of the looked-up value.
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">mdint 
<span class="currsymbol">lookupCT</span>
<script>explorer.outline.addDecl('lookupCT');</script>

(char[] name)(MDThread* <span class="funcparam">t</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Very similar to lookup, this function trades a bit of code bloat for the benefits of checking that the name is valid
at compile time and of being faster.  The name is validated and translated directly into a series of API calls, meaning
this function will be likely to be inlined.  The usage is exactly the same as lookup, except the name is now a template
parameter instead of a normal parameter.
<br><br>
<b>Returns:</b><br>
The stack index of the looked-up value.
<br><br>

</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</td></tr>
		<tr><td id="docfooter">
			Page was generated with
			<img src="candydoc/img/candydoc.gif" style="vertical-align:middle; position:relative; top:-1px">
			on Fri Jun 27 20:33:22 2008

		</td></tr>
	</table>
</div>
<script>
	explorer.packageExplorer.addModuleFull("minid.utils");
	explorer.packageExplorer.addModuleFull("minid.vm");
	explorer.packageExplorer.addModuleFull("minid.gc");
	explorer.packageExplorer.addModuleFull("minid.types");
	explorer.packageExplorer.addModuleFull("minid.alloc");
	explorer.packageExplorer.addModuleFull("minid.api");
	explorer.packageExplorer.addModuleFull("minid.interpreter");
	explorer.packageExplorer.addModuleFull("minid.ex");</script>
</body></html>


