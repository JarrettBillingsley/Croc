<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Croc: Debugging</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="crocstyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="container">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<img src="http://jfbillingsley.com/croc/chrome/site/banner.gif" alt="The Croc Programming Language" />
<!-- <table cellspacing="0" cellpadding="0"> -->
 <!-- <tbody> -->
 <!-- <tr style="height: 56px;"> -->
  <!-- <td style="padding-left: 0.5em;"> -->
   <!-- <div id="projectname">Croc -->
   <!-- </div> -->
   <!--<div id="projectbrief">The Croc Programming Language</div>-->
  <!-- </td> -->
 <!-- </tr> -->
 <!-- </tbody> -->
<!-- </table> -->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>API</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Debugging<div class="ingroups"><a class="el" href="group___a_p_i.html">API</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5fb35cce0ed5da2c20033cb414112333"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___debugging.html#ga5fb35cce0ed5da2c20033cb414112333">croc_debug_setHookFunc</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t, <a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> mask, <a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> hookDelay)</td></tr>
<tr class="separator:ga5fb35cce0ed5da2c20033cb414112333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga507935e31cbd95f4b6e8cf75b9e7aa00"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___a_p_i_types.html#gab14ee9a38c2105a6776912612194c348">word_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___debugging.html#ga507935e31cbd95f4b6e8cf75b9e7aa00">croc_debug_pushHookFunc</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t)</td></tr>
<tr class="separator:ga507935e31cbd95f4b6e8cf75b9e7aa00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c136642d8612cf3e0fe9fdef5d7f318"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___debugging.html#ga1c136642d8612cf3e0fe9fdef5d7f318">croc_debug_getHookMask</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t)</td></tr>
<tr class="separator:ga1c136642d8612cf3e0fe9fdef5d7f318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga03b43cfb0cb18efa4abb83402daa8eb0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___debugging.html#ga03b43cfb0cb18efa4abb83402daa8eb0">croc_debug_getHookDelay</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t)</td></tr>
<tr class="separator:ga03b43cfb0cb18efa4abb83402daa8eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa907ea7ff59bdfedce3e9458b3577125"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___debugging.html#gaa907ea7ff59bdfedce3e9458b3577125">croc_debug_printStack</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t)</td></tr>
<tr class="separator:gaa907ea7ff59bdfedce3e9458b3577125"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae7522427dea219c4d5a49ea44f0d5720"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___debugging.html#gae7522427dea219c4d5a49ea44f0d5720">croc_debug_printWholeStack</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t)</td></tr>
<tr class="separator:gae7522427dea219c4d5a49ea44f0d5720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga05fabe10eb0a21b094e31bab56c61ce0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___debugging.html#ga05fabe10eb0a21b094e31bab56c61ce0">croc_debug_printCallStack</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t)</td></tr>
<tr class="separator:ga05fabe10eb0a21b094e31bab56c61ce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Debugging. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga5fb35cce0ed5da2c20033cb414112333"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void croc_debug_setHookFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td>
          <td class="paramname"><em>hookDelay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the thread's <em>hook function</em>, which is a special function called at certain points during program execution which allows you to trace execution and inspect the internals of the program as it runs. </p>
<p>This can be used to make a debugger.</p>
<p>This expects the hook function to be on top of the stack. It can be either a function closure or <code>null</code> to remove the hook function instead. The hook function is popped.</p>
<p>There are four places the hook function can be called:</p>
<ul>
<li>When any function is called, right after its stack frame has been set up, but before the function begins execution;</li>
<li>When any function returns, right after the last instruction has executed, but before its stack frame is torn down;</li>
<li>At a new line of source code;</li>
<li>After every <em>n</em> bytecode instructions have been executed.</li>
</ul>
<p>There is only one hook function, and it will be called for any combination of these events that you specify; it's up to the hook function to see what kind of event it is and respond appropriately.</p>
<p>This hook function (as well as the mask and delay) is inherited by any new threads which the given thread creates after the hook was set.</p>
<p>While the hook function is being run, no hooks will be called (obviously, or else it would result in infinite recursion). When the hook function returns, execution will resume as normal until the hook function is called again.</p>
<p>You cannot yield from within the hook function.</p>
<dl class="section user"><dt>The hook function</dt><dd>When the hook function is called, the thread being hooked will be passed as <code>this</code> (since you could possibly set the same hook function to multiple threads) and the type of the hook event will be a string, its only parameter. This string can be one of the following values:</dd></dl>
<ul>
<li><code>"call"</code> for normal function calls.</li>
<li><code>"tailcall"</code> which is the same as <code>"call"</code> except there will not be a corresponding <code>"return"</code> when this function returns (or more precisely, the <em>previously</em> called function will not have a <code>"return"</code> event).</li>
<li><code>"return"</code> for when a function is about to return.</li>
<li><code>"line"</code> for when execution reaches a new line of source code.</li>
<li><code>"delay"</code> for when a certain number of bytecode instructions have been executed.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mask</td><td>controls which of the following events the hook function will be called for. It should be an or-ing together of the <a class="el" href="group___a_p_i_types.html#ga3d4f7256247f4931409e701ec872d895">CrocThreadHook</a> enum values. Note that if you use either one of <a class="el" href="group___a_p_i_types.html#gga3d4f7256247f4931409e701ec872d895a092a3d853543ebc109c436ad811e8735">CrocThreadHook_Call</a> or <a class="el" href="group___a_p_i_types.html#gga3d4f7256247f4931409e701ec872d895a47f6a336612f2e59dc80370008c44507">CrocThreadHook_TailCall</a>, you will get both kinds of call events. Also, the <a class="el" href="group___a_p_i_types.html#gga3d4f7256247f4931409e701ec872d895af96778b9f21a28e18007ce58d1074b6c">CrocThreadHook_Delay</a> flag isn't controlled by this mask, but by the <code>hookDelay</code> parameter. <br/>
 <br/>
 If this parameter is 0, the hook function is removed from the thread.</td></tr>
    <tr><td class="paramname">hookDelay</td><td>controls whether or not the hook function will be called for <code>"delay"</code> events. If this parameter is 0, it won't be. Otherwise, it indicates how often the <code>"delay"</code> hook event will occur. A value of 1 means it will occur after every bytecode instruction; a value of 2 means every other instruction, and so on. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga507935e31cbd95f4b6e8cf75b9e7aa00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___a_p_i_types.html#gab14ee9a38c2105a6776912612194c348">word_t</a> croc_debug_pushHookFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pushes the given thread's hook function onto its stack, or <code>null</code> if none is set on that thread. </p>

</div>
</div>
<a class="anchor" id="ga1c136642d8612cf3e0fe9fdef5d7f318"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> croc_debug_getHookMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the hook mask of the given thread (like was set with <a class="el" href="group___debugging.html#ga5fb35cce0ed5da2c20033cb414112333">croc_debug_setHookFunc</a>), or 0 if there is no hook set on that thread. </p>

</div>
</div>
<a class="anchor" id="ga03b43cfb0cb18efa4abb83402daa8eb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> croc_debug_getHookDelay </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the hook delay of the given thread (like was set with <a class="el" href="group___debugging.html#ga5fb35cce0ed5da2c20033cb414112333">croc_debug_setHookFunc</a>), or 0 if there is no delay hook on that thread. </p>

</div>
</div>
<a class="anchor" id="gaa907ea7ff59bdfedce3e9458b3577125"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void croc_debug_printStack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints out the contents of the current function's stack frame to standard output in the following format: </p>
<pre class="fragment">[xxx:yyyy] val: type</pre><p>Where <code>xxx</code> is the absolute stack index (within the thread's entire stack), yyyy is the stack index relative to the current function's stack frame, val is a raw string representation of the value, and type is its type. </p>

</div>
</div>
<a class="anchor" id="gae7522427dea219c4d5a49ea44f0d5720"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void croc_debug_printWholeStack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Same as <a class="el" href="group___debugging.html#gaa907ea7ff59bdfedce3e9458b3577125">croc_debug_printStack</a>, but prints the thread's <em>whole</em> stack, for all stack frames. </p>
<p>In this case the relative stack indexes can be negative, which means that the slot is in a previous stack frame. </p>

</div>
</div>
<a class="anchor" id="ga05fabe10eb0a21b094e31bab56c61ce0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void croc_debug_printCallStack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints out the thread's call stack to standard output in reverse, starting with the currently-executing function, in the following format: </p>
<pre class="fragment">Record &lt;name&gt;:
    Base: &lt;base&gt;
    Saved top: &lt;top&gt;
    Vararg base: &lt;vargBase&gt;
    Return slot: &lt;retSlot&gt;
    Expected results: &lt;numResults&gt;</pre><p>Where <code>name</code> is the name of the function at that level (or ??? if there is no function at that level); <code>base</code> is the absolute stack index where this activation record's stack frame begins; <code>top</code> is the absolute stack index of the end of its stack frame (which may and often does overlap the next frame); <code>vargBase</code> is the absolute stack index of where its variadic arguments, if any, begin; <code>retSlot</code> is the absolute stack index where its return values will be copied upon returning to the calling function; and <code>numResults</code> is the number of results the calling function is expecting it to return (or -1 for "all of them").</p>
<p>This only prints the current thread's call stack; it does not cross thread resume boundaries. </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 15 2014 10:46:48 for Croc by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</div> <!-- container -->
</body>
</html>
