<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Croc: GC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="crocstyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="container">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<img src="http://jfbillingsley.com/croc/chrome/site/banner.gif" alt="The Croc Programming Language" />
<!-- <table cellspacing="0" cellpadding="0"> -->
 <!-- <tbody> -->
 <!-- <tr style="height: 56px;"> -->
  <!-- <td style="padding-left: 0.5em;"> -->
   <!-- <div id="projectname">Croc -->
   <!-- </div> -->
   <!--<div id="projectbrief">The Croc Programming Language</div>-->
  <!-- </td> -->
 <!-- </tr> -->
 <!-- </tbody> -->
<!-- </table> -->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>API</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">GC<div class="ingroups"><a class="el" href="group___a_p_i.html">API</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9598c53f54c2c35390f23a4d32b62edd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___g_c.html#ga9598c53f54c2c35390f23a4d32b62edd">croc_gc_maybeCollect</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t)</td></tr>
<tr class="separator:ga9598c53f54c2c35390f23a4d32b62edd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9aa76bab17b65fadf0cc39643828517b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___g_c.html#ga9aa76bab17b65fadf0cc39643828517b">croc_gc_collect</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t)</td></tr>
<tr class="separator:ga9aa76bab17b65fadf0cc39643828517b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa17836f06458906da6f5d4aedca9ad91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___g_c.html#gaa17836f06458906da6f5d4aedca9ad91">croc_gc_collectFull</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t)</td></tr>
<tr class="separator:gaa17836f06458906da6f5d4aedca9ad91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad5ec346028e4ee15cd015a8468578e55"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___g_c.html#gad5ec346028e4ee15cd015a8468578e55">croc_gc_setLimit</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t, <a class="el" href="group___a_p_i_types.html#gaa4f20c0df04b8feb8809536c91700297">CrocGCLimit</a> type, <a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> lim)</td></tr>
<tr class="separator:gad5ec346028e4ee15cd015a8468578e55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga55d06ec130733d1f5078f0ae29726745"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___g_c.html#ga55d06ec130733d1f5078f0ae29726745">croc_gc_getLimit</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t, <a class="el" href="group___a_p_i_types.html#gaa4f20c0df04b8feb8809536c91700297">CrocGCLimit</a> type)</td></tr>
<tr class="separator:ga55d06ec130733d1f5078f0ae29726745"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Controlling the garbage collector. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga9598c53f54c2c35390f23a4d32b62edd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> croc_gc_maybeCollect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs a garbage collection cycle, but only if the VM decides it needs one. </p>

</div>
</div>
<a class="anchor" id="ga9aa76bab17b65fadf0cc39643828517b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> croc_gc_collect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forces a garbage collection cycle. </p>

</div>
</div>
<a class="anchor" id="gaa17836f06458906da6f5d4aedca9ad91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> croc_gc_collectFull </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forces a full garbage collection cycle. </p>
<p>This will also scan reference cycles for garbage. </p>

</div>
</div>
<a class="anchor" id="gad5ec346028e4ee15cd015a8468578e55"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> croc_gc_setLimit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#gaa4f20c0df04b8feb8809536c91700297">CrocGCLimit</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td>
          <td class="paramname"><em>lim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets various limits used by the garbage collector. </p>
<p>Most have an effect on how often GC collections are run. You can set these limits to better suit your program, or to enforce certain behaviors, but setting them incorrectly can cause the GC to thrash, collecting way too often and hogging the CPU. Be careful.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td><p class="starttd">is the limit type to set. The values are as follows:</p>
<ul>
<li><code>CrocGCLimit_NurseryLimit</code> - The size, in bytes, of the nursery generation. Defaults to 512KB. Most objects are initially allocated in the nursery. When the nursery fills up (the number of bytes allocated exceeds this limit), a collection will be triggered. Setting the nursery limit higher will cause collections to run less often, but they will take longer to complete. Setting the nursery limit lower will put more pressure on the older generation as it will not give young objects a chance to die off, as they usually do. Setting the nursery limit to 0 will cause a collection to be triggered on every allocation. That's probably bad.</li>
<li><code>CrocGCLimit_MetadataLimit</code> - The size, in bytes, of the GC metadata. Defaults to 128KB. The metadata includes two buffers: one keeps track of which old-generation objects have been modified; the other keeps track of which old- generation objects need to have their reference counts decreased. This is pretty low-level stuff, but generally speaking, the more object mutation your program has, the faster these buffers will fill up. When they do, a collection is triggered. Much like the nursery limit, setting this value higher will cause collections to occur less often but they will take longer. Setting it lower will put more pressure on the older generation, as it will tend to pull objects out of the nursery before they can have a chance to die off. Setting the metadata limit to 0 will cause a collection to be triggered on every mutation. That's also probably bad!</li>
<li><code>CrocGCLimit_NurserySizeCutoff</code> - The maximum size, in bytes, of an object that can be allocated in the nursery. Defaults to 256. If an object is bigger than this, it will be allocated directly in the old generation instead. This avoids having large objects fill up the nursery and causing more collections than necessary. Chances are this won't happen too often, unless you're allocating really huge class instances. Setting this value to 0 will effectively turn the GC algorithm into a regular deferred reference counting GC, with only one generation. Maybe that'd be useful for you?</li>
<li><code>CrocGCLimit_CycleCollectInterval</code> - Since the Croc reference implementation uses a form of reference counting to do garbage collection, it must detect cyclic garbage (which would otherwise never be freed). Cyclic garbage usually forms only a small part of all garbage, but ignoring it would cause memory leaks. In order to avoid that, the GC must occasionally run a separate cycle collection algorithm during the GC cycle. This is triggered when enough potential cyclic garbage is buffered (see the next limit type for that), or every <em>n</em> collections, whichever comes first. This limit is that <em>n</em>. It defaults to 50; that is, every 50 garbage collection cycles, a cycle collection will be forced, regardless of how much potential cyclic garbage has been buffered. Setting this limit to 0 will force a cycle collection at every GC cycle, which isn't that great for performance. Setting this limit very high will cause cycle collections only to be triggered if enough potential cyclic garbage is buffered, but it's then possible that that garbage can hang around until program end, wasting memory.</li>
<li><code>CrocGCLimit_CycleMetadataLimit</code> - As explained above, the GC will buffer potential cyclic garbage during normal GC cycles, and then when a cycle collection is initiated, it will look at that buffered garbage and determine whether it really is garbage. This limit is similar to metadataLimit in that it measures the size of a buffer, and when that buffer size crosses this limit, a cycle collection is triggered. This defaults to 128KB. The more cyclic garbage your program produces, the faster this buffer will fill up. Note that Croc is somewhat smart about what it considers potential cyclic garbage; only objects whose reference counts decrease to a non-zero value are candidates for cycle collection. Of course, this is only a heuristic, and can have false positives, meaning non-cyclic objects (living or dead) can be scanned by the cycle collector as well. Thus the cycle collector must be run to reclaim ALL dead objects.</li>
</ul>
<p class="endtd"></p>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lim</td><td>is the value of the limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the previous value of the limit that you set. </dd></dl>

</div>
</div>
<a class="anchor" id="ga55d06ec130733d1f5078f0ae29726745"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> croc_gc_getLimit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#gaa4f20c0df04b8feb8809536c91700297">CrocGCLimit</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets GC limits as explained above. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>is the type of limit to get. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the current value of that limit. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Oct 18 2014 11:19:00 for Croc by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</div> <!-- container -->
</body>
</html>
