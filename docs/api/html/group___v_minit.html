<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Croc: VM initialization and teardown</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="crocstyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="container">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<img src="http://jfbillingsley.com/croc/chrome/site/banner.gif" alt="The Croc Programming Language" />
<!-- <table cellspacing="0" cellpadding="0"> -->
 <!-- <tbody> -->
 <!-- <tr style="height: 56px;"> -->
  <!-- <td style="padding-left: 0.5em;"> -->
   <!-- <div id="projectname">Croc -->
   <!-- </div> -->
   <!--<div id="projectbrief">The Croc Programming Language</div>-->
  <!-- </td> -->
 <!-- </tr> -->
 <!-- </tbody> -->
<!-- </table> -->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>API</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">VM initialization and teardown<div class="ingroups"><a class="el" href="group___a_p_i.html">API</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga1e9725b13de494088807a4f21232f771"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_minit.html#ga1e9725b13de494088807a4f21232f771">croc_vm_openDefault</a>()&#160;&#160;&#160;(<a class="el" href="group___v_minit.html#gae6a5be97af6b43e3195a5741bfa6807a">croc_vm_open</a>(&amp;<a class="el" href="group___v_minit.html#ga3f64de7e3acf057d6622b89eb1b82e77">croc_DefaultMemFunc</a>, 0))</td></tr>
<tr class="separator:ga1e9725b13de494088807a4f21232f771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7dc689f634a9babf3d5cb5dc5826078"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_minit.html#gaa7dc689f634a9babf3d5cb5dc5826078">croc_vm_loadAllUnsafeLibs</a>(t)&#160;&#160;&#160;(<a class="el" href="group___v_minit.html#ga61c31c7c0e9d1b0c78df42e2a74b7ffd">croc_vm_loadUnsafeLibs</a>((t), <a class="el" href="group___a_p_i_types.html#ggada39b819f0a0a5d0ffc4ecbd6d2a9269a1114a4918c866e9dca6f7bb2ae6da7b1">CrocUnsafeLib_All</a>))</td></tr>
<tr class="separator:gaa7dc689f634a9babf3d5cb5dc5826078"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga818af3f22cd431801a955b57a65a5073"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_minit.html#ga818af3f22cd431801a955b57a65a5073">croc_vm_loadAllAvailableAddons</a>(t)&#160;&#160;&#160;(<a class="el" href="group___v_minit.html#ga8868a05df863542c8e198e0f685dd649">croc_vm_loadAvailableAddonsExcept</a>((t), <a class="el" href="group___a_p_i_types.html#gga6594f6d2914d6958c922ffad0f9a83cea44b50ab602e9fec5330d48003aab1694">CrocAddons_None</a>))</td></tr>
<tr class="separator:ga818af3f22cd431801a955b57a65a5073"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3f64de7e3acf057d6622b89eb1b82e77"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_minit.html#ga3f64de7e3acf057d6622b89eb1b82e77">croc_DefaultMemFunc</a> (void *ctx, void *p, <a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> oldSize, <a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a> newSize)</td></tr>
<tr class="separator:ga3f64de7e3acf057d6622b89eb1b82e77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae6a5be97af6b43e3195a5741bfa6807a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_minit.html#gae6a5be97af6b43e3195a5741bfa6807a">croc_vm_open</a> (<a class="el" href="group___a_p_i_types.html#ga7cd61b5bc63c9bac53a5390b02bc88b5">CrocMemFunc</a> memFunc, void *ctx)</td></tr>
<tr class="separator:gae6a5be97af6b43e3195a5741bfa6807a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga734a30fc139df581c256cea1fe8862bb"><td class="memItemLeft" align="right" valign="top">const char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_minit.html#ga734a30fc139df581c256cea1fe8862bb">croc_vm_includedAddons</a> ()</td></tr>
<tr class="separator:ga734a30fc139df581c256cea1fe8862bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87912c2a6cf5a8704e4e08d1752fb9a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_minit.html#ga87912c2a6cf5a8704e4e08d1752fb9a7">croc_vm_close</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t)</td></tr>
<tr class="separator:ga87912c2a6cf5a8704e4e08d1752fb9a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61c31c7c0e9d1b0c78df42e2a74b7ffd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_minit.html#ga61c31c7c0e9d1b0c78df42e2a74b7ffd">croc_vm_loadUnsafeLibs</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t, <a class="el" href="group___a_p_i_types.html#gada39b819f0a0a5d0ffc4ecbd6d2a9269">CrocUnsafeLib</a> libs)</td></tr>
<tr class="separator:ga61c31c7c0e9d1b0c78df42e2a74b7ffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66c107563723b752a6fc176373b7b8ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_minit.html#ga66c107563723b752a6fc176373b7b8ba">croc_vm_loadAddons</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t, <a class="el" href="group___a_p_i_types.html#ga6594f6d2914d6958c922ffad0f9a83ce">CrocAddons</a> libs)</td></tr>
<tr class="separator:ga66c107563723b752a6fc176373b7b8ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8868a05df863542c8e198e0f685dd649"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___v_minit.html#ga8868a05df863542c8e198e0f685dd649">croc_vm_loadAvailableAddonsExcept</a> (<a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *t, <a class="el" href="group___a_p_i_types.html#ga6594f6d2914d6958c922ffad0f9a83ce">CrocAddons</a> exclude)</td></tr>
<tr class="separator:ga8868a05df863542c8e198e0f685dd649"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Creating, setting up, and destroying Croc VMs. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga1e9725b13de494088807a4f21232f771"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define croc_vm_openDefault</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="group___v_minit.html#gae6a5be97af6b43e3195a5741bfa6807a">croc_vm_open</a>(&amp;<a class="el" href="group___v_minit.html#ga3f64de7e3acf057d6622b89eb1b82e77">croc_DefaultMemFunc</a>, 0))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a croc VM using <a class="el" href="group___v_minit.html#ga3f64de7e3acf057d6622b89eb1b82e77">croc_DefaultMemFunc</a> as the allocator. </p>

</div>
</div>
<a class="anchor" id="gaa7dc689f634a9babf3d5cb5dc5826078"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define croc_vm_loadAllUnsafeLibs</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="group___v_minit.html#ga61c31c7c0e9d1b0c78df42e2a74b7ffd">croc_vm_loadUnsafeLibs</a>((t), <a class="el" href="group___a_p_i_types.html#ggada39b819f0a0a5d0ffc4ecbd6d2a9269a1114a4918c866e9dca6f7bb2ae6da7b1">CrocUnsafeLib_All</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads all unsafe libraries into the given thread's VM. </p>

</div>
</div>
<a class="anchor" id="ga818af3f22cd431801a955b57a65a5073"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define croc_vm_loadAllAvailableAddons</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">t</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="group___v_minit.html#ga8868a05df863542c8e198e0f685dd649">croc_vm_loadAvailableAddonsExcept</a>((t), <a class="el" href="group___a_p_i_types.html#gga6594f6d2914d6958c922ffad0f9a83cea44b50ab602e9fec5330d48003aab1694">CrocAddons_None</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads all available addons (all which have been compile in) into the given thread's VM. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga3f64de7e3acf057d6622b89eb1b82e77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* croc_DefaultMemFunc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td>
          <td class="paramname"><em>oldSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#gadcf7542809ee167fbe38441459138101">uword_t</a>&#160;</td>
          <td class="paramname"><em>newSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is a default implementation of <a class="el" href="group___a_p_i_types.html#ga7cd61b5bc63c9bac53a5390b02bc88b5">CrocMemFunc</a> which uses the C library <code>realloc</code> function to implement memory allocation and deallocation. </p>
<p>This is the function used by <a class="el" href="group___v_minit.html#ga1e9725b13de494088807a4f21232f771">croc_vm_openDefault</a>. </p>

</div>
</div>
<a class="anchor" id="gae6a5be97af6b43e3195a5741bfa6807a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a>* croc_vm_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga7cd61b5bc63c9bac53a5390b02bc88b5">CrocMemFunc</a>&#160;</td>
          <td class="paramname"><em>memFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a new Croc VM with the given memory allocator function, and returns a pointer to the VM's main thread. </p>
<p>This VM will be completely independent from any other Croc VM, and you can open as many as you like (memory permitting). While it's not safe for multiple threads to access a single VM without synchronization, accessing separate VMs from separate threads is perfectly fine.</p>
<p>The safe standard libraries will already be loaded into the global namespace.</p>
<p>When you're done with a VM, you should call <a class="el" href="group___v_minit.html#ga87912c2a6cf5a8704e4e08d1752fb9a7">croc_vm_close</a> to free the memory and call any pending finalizers.</p>
<p>If you want to make more threads within this VM, use the <a class="el" href="group___threads.html#gaa78713492d5d69ad7f082e4217620f25">croc_thread_new</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">memFunc</td><td>is the memory allocation function. See <a class="el" href="group___a_p_i_types.html#ga7cd61b5bc63c9bac53a5390b02bc88b5">CrocMemFunc</a> for how it should work. </td></tr>
    <tr><td class="paramname">ctx</td><td>is the opaque context pointer passed to memFunc whenever it's called. Croc does nothing else with this. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga734a30fc139df581c256cea1fe8862bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char** croc_vm_includedAddons </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>an array of names of addons that were compiled into this Croc library. The array is terminated with a NULL entry. This is a constant array, so no need to worry about ownership. </dd></dl>

</div>
</div>
<a class="anchor" id="ga87912c2a6cf5a8704e4e08d1752fb9a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void croc_vm_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees all objects and memory associated with the VM that owns the given thread. </p>
<p>Calls finalizers on objects as well.</p>
<p>In addition, this will also check if there were any memory leaks... if so, please report a bug! </p>

</div>
</div>
<a class="anchor" id="ga61c31c7c0e9d1b0c78df42e2a74b7ffd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void croc_vm_loadUnsafeLibs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#gada39b819f0a0a5d0ffc4ecbd6d2a9269">CrocUnsafeLib</a>&#160;</td>
          <td class="paramname"><em>libs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads unsafe standard libraries into the global namespace of the given thread's VM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">libs</td><td>controls which libraries are loaded, and should be an or-ing together of members of the <a class="el" href="group___a_p_i_types.html#gada39b819f0a0a5d0ffc4ecbd6d2a9269">CrocUnsafeLib</a> enum. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga66c107563723b752a6fc176373b7b8ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void croc_vm_loadAddons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6594f6d2914d6958c922ffad0f9a83ce">CrocAddons</a>&#160;</td>
          <td class="paramname"><em>libs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads addon libraries into the VM. </p>
<p>You must have compiled these addons into your Croc library to load them. You'll get a runtime error if you try to load one that wasn't compiled in.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">libs</td><td>controls which libraries are loaded, and should be an or-ing together of members of the <a class="el" href="group___a_p_i_types.html#ga6594f6d2914d6958c922ffad0f9a83ce">CrocAddons</a> enum. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga8868a05df863542c8e198e0f685dd649"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void croc_vm_loadAvailableAddonsExcept </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6a1f60650d3a078e26815cda6fd01d18">CrocThread</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___a_p_i_types.html#ga6594f6d2914d6958c922ffad0f9a83ce">CrocAddons</a>&#160;</td>
          <td class="paramname"><em>exclude</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads addons which were compiled into the Croc library. </p>
<p>This uses the <code>CROC_XXX_ADDON</code> macros to determine whether the addons were compiled in or not.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exclude</td><td>lets you exclude addons from being loaded, and should be an or-ing together of members of the <a class="el" href="group___a_p_i_types.html#ga6594f6d2914d6958c922ffad0f9a83ce">CrocAddons</a> enum. (Passing CrocAddons_None will cause all available addons to be loaded.) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 15 2014 10:46:48 for Croc by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</div> <!-- container -->
</body>
</html>
